# pm_encoder

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

**pm_encoder** is a context serialization tool for LLM workflows. It converts codebases into AI-digestible context with intelligent token budgeting.

### The Twins Architecture
- **Python v1.7.0** - Reference implementation, feature prototyping
- **Rust v1.0.0** - High-performance engine, MCP server mode
- **pm_coach** - Differential testing tool for parity verification

### Key Features
- Token budgeting with drop/truncate/hybrid strategies
- Context lenses (architecture, security, debug, minimal)
- Priority groups for intelligent file selection
- Streaming mode for low-latency output
- **MCP Server Mode** - JSON-RPC 2.0 protocol for AI CLI integration

## Quick Start

```bash
# Python (reference)
./pm_encoder.py . --token-budget 100k --lens architecture

# Rust (10x faster)
./rust/target/release/pm_encoder . --token-budget 100k --lens architecture
```

## MCP Server Mode

The Rust engine supports MCP (Model Context Protocol) for integration with AI CLIs:

```bash
# Run as MCP server (JSON-RPC 2.0 over stdio)
./rust/target/release/pm_encoder --server /path/to/project
```

**Available Tools:**
- `get_context` - Serialize directory with lens/budget options
- `zoom` - Symbol-aware zoom into functions/classes/files
- `session_list` - List saved zoom sessions
- `session_create` - Create new zoom session
- `report_utility` - Report file utility for learning

**Configuration:**
```json
// ~/.claude/mcp.json or ~/.gemini/settings.json
{
  "mcpServers": {
    "pm_encoder": {
      "command": "/path/to/pm_encoder",
      "args": ["--server", "/path/to/project"]
    }
  }
}
```

## Commands

Common commands detected for this project:
- `make`
- `make test`

## Project Structure

```
pm_encoder/
├── docs/
│   ├── BLUEPRINT.md
│   ├── KNOWLEDGE_BASE.md
│   ├── MULTI_AI_STORY.html
│   ├── RUST_GROWTH_STRATEGY.md
│   ├── THE_TURING_AUDIT.md
│   └── THE_TWINS_ARCHITECTURE.md
├── examples/
│   └── plugins/
│       └── rust_analyzer.py
├── htmlcov/
│   ├── class_index.html
│   ├── coverage_html_cb_bcae5fc4.js
│   ├── favicon_32_cb_58284776.png
│   ├── function_index.html
│   ├── index.html
│   ├── keybd_closed_cb_ce680311.png
│   ├── pm_encoder_py.html
│   ├── status.json
│   ├── style_cb_a5a05ca4.css
│   ├── z_a44f0ac069e85531_test_comprehensive_py.html
│   ├── z_a44f0ac069e85531_test_pm_encoder_py.html
│   └── z_f7dc1f716e984ff2___init___py.html
├── LLM/
│   └── 2025-07-23_sip-4_enhance-pm-encoder-with-sorting.md
├── rust/
│   ├── src/
│   │   ├── bin/
│   │   └── lib.rs
│   ├── Cargo.lock
│   ├── Cargo.toml
│   └── README.md
├── scripts/
│   ├── backup.sh
│   ├── bootstrap.sh
│   └── doc_gen.py
├── test_vectors/
│   ├── basic_serialization.json
│   ├── binary_detection.json
│   ├── large_file_skip.json
│   ├── python_analyzer.json
│   └── README.md
├── tests/
│   ├── fixtures/
│   │   ├── edge_cases/
│   │   ├── javascript/
│   │   ├── json/
│   │   ├── markdown/
│   │   ├── python/
│   │   ├── rust/
│   │   ├── shell/
│   │   └── yaml/
│   ├── generate_vectors.py
│   ├── test_comprehensive.py
│   └── test_pm_encoder.py
├── CHANGELOG.md
├── CLAUDE.md
├── CONTEXT.txt
├── context_script.sh
├── CONTRIBUTING.md
├── GEMINI_INSTRUCTIONS.txt
├── LICENSE
├── Makefile
├── PLUGIN_GUIDE.md
├── pm_encoder.py
├── QA_INFRASTRUCTURE.md
├── README.md
├── SYSTEM_INSTRUCTIONS.md
├── TESTING.md
└── TUTORIAL.md
```

**Statistics:**
- Files: 50
- Context size: 41,775 bytes (40.8 KB)

For the complete codebase context, see `CONTEXT.txt` in this directory.

---

**Regenerate these files:**
```bash
./pm_encoder.py . --init-prompt --init-lens debug --target claude
```

*Generated by pm_encoder v1.7.0 using the 'debug' lens*
